<% content_for :title, "Dashboard | Traffle" %>
<div class="container-fluid my_top_div">
  <div class="row">
    <center>
      <div class="container">
        <div class="modal fade" id="addPhoto" style="margin-top:10em;">
          <div class="modal-dialog">
            <div class="modal-content">
              <!-- Header -->
              <div class="modal-header" style="background: #F5CBA7;">
              <button type="button" class="close" data-dismiss="modal">&times;</button>
              <center><h4 class="heading_text" style="color:white;">Choose Avatar</h4></center>
              </div>
              <!-- Body (form) -->
              <div class="modal-body">
                <div class="form-group">
                  <div class="row">
                    <div class="col-md-12">
                      <center>
                        <%= form_for :user, url: change_image_user_dashboard_path(current_user.id), html: { multipart: true } do |form| %>
                        <%if current_user.avatar.present? %>
                          <%= image_tag (current_user.avatar(:original)),id: 'postimg',class: 'img-responsive img-circle img-thumbnail profile-img', style:"width:200px;height:200px;" %>
                        <%elsif current_user.image_url != nil%>
                          <%= image_tag (current_user.image_url),id: 'postimg',class: 'img-responsive img-circle img-thumbnail profile-img', style:"width:200px;height:200px;" %>
                        <%else %>
                          <%= image_tag ("user.png"),id: 'postimg', class: 'img-responsive img-circle img-thumbnail profile-img', style:"width:200px;height:200px;" %>
                        <%end%>
                        <%= form.file_field :avatar, id:"post-upload",class: "btn btn-info" %>
                        <h4 class="heading_text" style="font-style: italic;color:#2DBF7F;font-weight:normal;">Preview</h4>
                      </center>
                    </div>
                  </div>
                </div>
              </div>
              <div class="modal-footer">
                <div class="row">
                  <div class="col-md-3"></div>
                  <div class="col-md-3">
                    <%= form.submit "Save", class:"btn btn-success btn-block" %>
                  </div>
                  <div class="col-md-3">
                    <button type="button" class="btn btn-danger btn-block" data-dismiss="modal">Close</button>
                  </div>
                  <div class="col-md-3"></div>
                </div>
              <% end %>
              </div>
            </div>
          </div>
        </div>
      </div>
    </center>
  </div>
  <div class="row">
    <%= render 'user/user_panel' %>
    <div class="col-md-9">
      <div class="jumbotron">
        <h3><center>User Dashboard</center></h3>
        <div class="row" style="margin-top:1em;">
          <div class="col-md-6" >
            <div class="row jumbotron" style="background-color:#234565">
              <div class="col-md-12 col-xs-12">
                <h4>My Wallet</h4>
                <hr style="height:2px;background:#000000; margin-right:1em;">
              </div>
              <div class="col-md-6 col-xs-12">
                <div class="row">
                  <div class="col-md-12 col-xs-12">
                    <label>Balance</label>
                  </div>
                  <div class="col-md-12 col-xs-12">
                    <label>₦ <span>0</span></label>
                  </div>
                </div>
              </div>
              <div class="col-md-6 col-xs-12">
                <button class="btn btn-info" style="float:right;">Recharge</button>
              </div>
              <div class="col-md-12 col-xs-12">
                <br>
                <label>Transactions</label>
              </div>
              <div class="col-md-12 col-xs-12">
                <br>
                <h5>No Transactions found</label>
              </div>
            </div>
          </div>
          <div class="col-md-6">
             <div class="row jumbotron" style="background-color: #654321; padding-bottom: 7.5em;">
               <div class="col-md-12 col-xs-12">
                 <h4>Cash Redemption</h4>
                 <hr style="height:2px;background:#000000; margin-right:1em;">
               </div>
               <div class="col-md-12">
               </div>
               <div class="col-md-12 col-xs-12">
                 <center><h3>No Available CASH Prizes</h3></center>
               </div>
               <div class="col-md-12 col-xs-12">
                 <center><%= link_to("Request For withdraw", request_for_withdraw_user_withdraws_path, class:"btn btn-success")%></center>
               </div>
             </div>
          </div>
          <div class="col-md-12">
          </div>
          <div class="col-md-12">
             <div class="row jumbotron" style="background-color: #789456; padding-bottom: 7.5em;">
               <div class="col-md-12 col-xs-12">
                 <h4>My Transactions</h4>
                 <hr style="height:2px;background:#000000; margin-right:1em;">
               </div>
               <div class="col-md-12">
               </div>
               <table class="table table-hover">
                <thead>
                  <tr>
                    <th>Transaction Detail</th>
                  </tr>
                </thead>
                <tbody>
                  <% @all_transactions.each do |n| %>
                    <tr>
                      <% @t = n.created_at.to_s%>
                      <% @t = @t[0..18]%>
                      <td>You commited a transaction of amount <bold><%= n.amount %> <label>₦ </label></bold> at <%= @t %></td>
                    </tr>
                  <% end  %>
                </tbody>
              </table>
               <div class="col-md-12 col-xs-12">
                 <center></center>
               </div>
             </div>
          </div>
          <div class="col-md-12">
             <div class="row jumbotron" style="background-color: #789456; padding-bottom: 7.5em;">
               <div class="col-md-12 col-xs-12">
                 <h4>Notifications</h4>
                 <hr style="height:2px;background:#000000; margin-right:1em;">
                 <table class="table table-hover">
                  <thead>
                    <tr>
                      <th>Description</th>
                    </tr>
                  </thead>
                  <tbody>
                    <% @all_notifications.each do |n| %>
                      <tr>
                        <td><%= n.description %></td>
                      </tr>
                    <% end  %>
                  </tbody>
                </table>
               </div>
             </div>
          </div>
          <div class="col-md-6">
             <div class="row jumbotron" style="background-color: #789456; padding-bottom: 7.5em;">
               <div class="col-md-12 col-xs-12">
                 <h4>Draw History</h4>
                 <hr style="height:2px;background:#000000; margin-right:1em;">
               </div>
               <div class="col-md-12">
               </div>
               <div class="col-md-6 col-xs-12">
                 <h5>Draws Entered</h5>
               </div>
               <div class="col-md-6 col-xs-12">
                 <h5>Draws Won</h5>
               </div>
               <div class="col-md-6 col-xs-12">
                 <h5><span>0</span></h5>
               </div>
               <div class="col-md-6 col-xs-12">
                 <h5><span>0</span></h5>
               </div>
             </div>
          </div>
          <div class="col-md-6">
             <div class="row jumbotron" style="background-color: #789456; padding-bottom: 7.5em;">
               <div class="col-md-12 col-xs-12">
                 <h4>Play History</h4>
                 <hr style="height:2px;background:#000000; margin-right:1em;">
               </div>
               <div class="col-md-12">
               </div>
               <div class="col-md-6 col-xs-12">
                 <h5>Tickets Purchased:</h5>
               </div>
               <div class="col-md-6 col-xs-12">
                 <h5>0</h5>
               </div>

             </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>





  <!-- *************************** Start Script for Uploading Image in Post ************************* -->
  <script>
  	$(document).ready(function() {
  		$("#post-upload").on('change', function() {
  			//Get count of selected files
  			var countFiles = $(this)[0].files.length;
  			var imgPath = $(this)[0].value;
  			var extn = imgPath.substring(imgPath.lastIndexOf('.') + 1).toLowerCase();
  			var image_holder = $("#postImage-holder");
  			image_holder.empty();
  			if (extn == "gif" || extn == "png" || extn == "jpg" || extn == "jpeg") {
  				if (typeof(FileReader) != "undefined") {
  					//loop for each file selected for uploaded.
  					for (var i = 0; i < countFiles; i++)
  					{
  						var reader = new FileReader();
  						reader.onload = function(e) {
  							$('#postimg').attr('src', e.target.result);

  						}
  						image_holder.show();
  						reader.readAsDataURL($(this)[0].files[i]);
  					}
  				} else {
  					alert("This browser does not support FileReader.");
  				}
  			}else {
  				alert("Please select only images");
  			}
  		});
  	});
  </script>
  <!-- *************************** End Script for Uploading Image in Post ************************* -->
